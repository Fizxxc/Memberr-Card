<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <div class="container py-5">
    <h2>Dashboard Admin</h2>
    <div id="user-list" class="mt-4"></div>
  </div>

  <script type="module">
    import { db } from './firebaseConfig.js';
    import { ref, onValue, update, remove } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

    const userList = document.getElementById("user-list");
    const usersRef = ref(db, 'users');

    onValue(usersRef, (snapshot) => {
      userList.innerHTML = "";
      snapshot.forEach(child => {
        const user = child.val();
        const key = child.key;
        const div = document.createElement("div");
        div.className = "card p-3 mb-2";
        div.innerHTML = `
          <strong>${user.nama}</strong> - ${user.email}<br/>
          Poin: <input type="number" value="${user.poin}" id="poin-${key}" />
          Kartu: ${user.kartu}<br/>
          <button class="btn btn-success btn-sm" onclick="updatePoin('${key}')">Update Poin</button>
          <button class="btn btn-danger btn-sm" onclick="hapusUser('${key}')">Hapus</button>
        `;
        userList.appendChild(div);
      });
    });

    window.updatePoin = function(uid) {
      const newPoin = parseInt(document.getElementById(`poin-${uid}`).value);
      update(ref(db, 'users/' + uid), { poin: newPoin });
    };

    window.hapusUser = function(uid) {
      if (confirm("Yakin ingin menghapus?")) {
        remove(ref(db, 'users/' + uid));
      }
    };
  </script>
</body>
</html>
